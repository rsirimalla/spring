spring:
  application:
    name: notification-service

  # Kafka Consumer Configuration
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
    
    consumer:
      group-id: notification-service-group
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: io.confluent.kafka.serializers.KafkaAvroDeserializer
      
      # Consumer properties for reliability
      enable-auto-commit: false
      max-poll-records: 10
      
      properties:
        # Schema Registry Configuration
        schema.registry.url: ${SCHEMA_REGISTRY_URL:http://localhost:8081}
        
        # For Confluent Cloud with basic auth (uncomment and configure):
        # basic.auth.credentials.source: USER_INFO
        # basic.auth.user.info: ${SCHEMA_REGISTRY_API_KEY}:${SCHEMA_REGISTRY_API_SECRET}
        
        # Avro specific settings
        specific.avro.reader: true
        
    # Kafka Listener Configuration
    listener:
      ack-mode: manual
      concurrency: 3
      
    # Kafka Security Configuration for Confluent Cloud with OAuth
    properties:
      # For OAuth 2.0 Authentication (Confluent Cloud):
      # security.protocol: SASL_SSL
      # sasl.mechanism: OAUTHBEARER
      # sasl.jaas.config: org.apache.kafka.common.security.oauthbearer.OAuthBearerLoginModule required clientId='${OAUTH_CLIENT_ID}' clientSecret='${OAUTH_CLIENT_SECRET}' scope='${OAUTH_SCOPE}';
      # sasl.login.callback.handler.class: org.apache.kafka.common.security.oauthbearer.secured.OAuthBearerLoginCallbackHandler
      
      # For API Key Authentication (Confluent Cloud - simpler alternative):
      # security.protocol: SASL_SSL
      # sasl.mechanism: PLAIN
      # sasl.jaas.config: org.apache.kafka.common.security.plain.PlainLoginModule required username='${KAFKA_API_KEY}' password='${KAFKA_API_SECRET}';
      
      # SSL Configuration for Confluent Cloud
      # ssl.endpoint.identification.algorithm: https

server:
  port: 8081

# Application Specific Configuration
kafka:
  topics:
    order-events: order-events
    order-events-dlq: order-events-dlq  # Dead Letter Queue

# Notification Configuration
notification:
  email:
    enabled: true
    from: noreply@example.com
  sms:
    enabled: false

logging:
  level:
    com.example.notification: DEBUG
    org.springframework.kafka: INFO
    org.apache.kafka: WARN
